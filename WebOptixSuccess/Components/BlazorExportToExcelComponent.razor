@using OptixSuccess.Services

@inject IJSRuntime js

<row Class="d-flex px-0 mx-0 mb-1">
    <RadzenButton Click="@DownloadExcelFile" Text="DownloadExcelFile"/>
    <button @onclick="DownloadExcelFile" class="p-0 ml-auto mr-2" style="background-color: transparent" title="Download">
        <span class="fa fa-file-excel fa-lg m-0" style="color: #008000; background-color: white;" aria-hidden="true"></span>
    </button>
</row>

@code {
    private void DownloadExcelFile()
    {
        var excelBytes = ExcelService.GenerateExcelWorkbook();
        js.InvokeVoidAsync("saveAsFile", $"test_{DateTime.Now.ToString("yyyyMMdd_HHmmss")}.xlsx", Convert.ToBase64String(excelBytes));
    }
}